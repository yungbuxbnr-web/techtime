
# Android Configuration Guide for TechTime

## Overview
This document outlines the Android-specific configurations applied to the TechTime app for optimal performance and compatibility.

## Key Configurations

### 1. SDK Versions
- **Compile SDK**: 35 (Android 15)
- **Target SDK**: 35 (Android 15)
- **Min SDK**: 24 (Android 7.0)
- **Build Tools**: 35.0.0

### 2. Kotlin Configuration
- **Version**: 2.0.21
- **Reason**: Compatible with KSP (Kotlin Symbol Processing) used by Expo SDK 54
- **JVM Target**: 17

### 3. NDK Configuration
- **Version**: 26.1.10909125
- **C++ Standard**: C++17 with RTTI and exceptions
- **STL**: c++_shared

### 4. Gradle Optimization
- **JVM Heap**: 6144MB (6GB)
- **Max Metaspace**: 1536MB
- **Parallel Builds**: Enabled
- **Caching**: Enabled
- **Daemon**: Enabled (1 hour timeout)

### 5. Build Features
- **Hermes**: Enabled (optimized JavaScript engine)
- **New Architecture**: Enabled (React Native's new architecture)
- **ProGuard**: Enabled for release builds
- **Resource Shrinking**: Enabled for release builds

### 6. Permissions
Required permissions:
- USE_BIOMETRIC / USE_FINGERPRINT (for authentication)
- CAMERA (for scanning)
- POST_NOTIFICATIONS (for notifications)
- SCHEDULE_EXACT_ALARM (for background tasks)
- RECEIVE_BOOT_COMPLETED (for background tasks)
- WAKE_LOCK (for background tasks)
- Storage permissions (for file operations)

Blocked permissions:
- Location permissions (not needed for this app)

### 7. Custom Plugins
The following Expo config plugins are applied:

#### kotlinVersion.plugin.cjs
- Sets Kotlin version to 2.0.21
- Ensures KSP compatibility

#### gradleWrapperConfig.plugin.cjs
- Configures Gradle properties
- Optimizes for CI/CD and local builds
- Sets network timeouts

#### cppBuildConfig.plugin.cjs
- Configures NDK version
- Sets CMake flags for C++ builds

#### fbjniExclusion.plugin.cjs
- Excludes duplicate fbjni classes
- Prevents build conflicts

#### androidOptimization.plugin.cjs
- Configures ProGuard and resource shrinking
- Sets packaging options
- Optimizes AndroidManifest.xml

## Building for Android

### Local Development Build
```bash
npm run android
```

### Production APK Build
```bash
npm run build:android
```

### EAS Cloud Build
```bash
# Development build
npm run build:eas:android

# Preview build
npm run build:preview:android

# Production build
npm run build:eas:android
```

### Production AAB Build (for Play Store)
```bash
eas build --platform android --profile production-aab
```

## Prebuild
To generate native Android project files:
```bash
npm run prebuild:android
```

This will create the `android/` directory with all native configuration applied.

## Troubleshooting

### Kotlin Version Errors
If you see errors about unsupported Kotlin versions, ensure:
1. `gradle.properties` has `kotlinVersion=2.0.21`
2. The kotlinVersion plugin is in the plugins array
3. Run `npm run prebuild:android` to regenerate native files

### Build Memory Issues
If builds fail with OutOfMemoryError:
1. Check `gradle.properties` has proper JVM args
2. Increase heap size if needed
3. Close other applications during build

### Duplicate Class Errors
If you see duplicate class errors:
1. The fbjniExclusion plugin should handle this
2. Run `npm run gradle:clean` to clean build cache
3. Run `npm run prebuild:android` to regenerate

### Gradle Daemon Issues
If Gradle daemon causes problems:
```bash
npm run gradle:stop
npm run gradle:clean
```

## Performance Optimizations

### Release Build Optimizations
- ProGuard minification enabled
- Resource shrinking enabled
- Hermes bytecode compilation
- Native library stripping

### Development Build Optimizations
- Fast refresh enabled
- Source maps enabled
- Debug symbols included

## Security Considerations
- Backup disabled (allowBackup: false)
- No location permissions
- Biometric authentication required
- Secure local storage only

## Next Steps
1. Test on physical Android devices (various SDK versions)
2. Test on different screen sizes and densities
3. Verify all permissions work correctly
4. Test release build performance
5. Submit to Google Play Store when ready
